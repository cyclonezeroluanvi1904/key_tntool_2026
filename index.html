<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>TNTOOL — Get Key</title>

<style>
/* (CSS của bạn giữ nguyên, mình không động) */
:root{--bg:#020204;--panel:#04110a;--accent:#00ff6a;--muted:#6fbf9a}
html,body{height:100%;margin:0;font-family:Inter, ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace;background:radial-gradient(circle at 10% 10%, #001611, #000000 40%);color:#cfeee1}
.wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px}
.card{width:760px;max-width:92vw;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:14px;padding:28px;border:1px solid rgba(0,255,106,0.06);box-shadow:0 12px 50px rgba(0,0,0,0.7);display:flex;gap:20px;align-items:center}
.logo{width:140px;height:140px;flex-shrink:0;display:flex;align-items:center;justify-content:center;border-radius:18px;background:linear-gradient(135deg,#00120a,#00221a);box-shadow:0 8px 40px rgba(0,255,106,0.06), inset 0 -8px 22px rgba(0,0,0,0.6);overflow:hidden}
.logo img{width:100%;height:100%;object-fit:cover}
.body{flex:1}
.title{color:#00ff6a;animation:neon 3s infinite}
.key-box{background:#001610;padding:18px;border-radius:10px;border:1px solid rgba(0,255,106,0.2);display:flex;gap:12px}
.key-text{flex:1}
.btn{background:linear-gradient(90deg,#00ff6a,#07b47a);border:none;padding:10px 18px;border-radius:8px;font-weight:700;cursor:pointer}
</style>
</head>

<body>
<div class="wrap">
  <div class="card">
    <div class="logo">TN</div>
    <div class="body">
      <h2 class="title">TNTOOL VERIFY</h2>
      <div class="key-box">
        <div class="key-text" id="keyText">Đang kiểm tra...</div>
        <button class="btn" id="copyBtn">COPY KEY</button>
      </div>
    </div>
  </div>
</div>

<script>
const SECRET = "TNTOOL_SECRET_2025";

async function sha256(str) {
  const buf = await crypto.subtle.digest(
    "SHA-256",
    new TextEncoder().encode(str)
  );
  return new Uint8Array(buf);
}

async function keystream(len) {
  let out = new Uint8Array(len);
  let pos = 0, i = 0;
  while (pos < len) {
    const hash = await sha256(`${SECRET}:${i++}`);
    for (let b of hash) {
      if (pos < len) out[pos++] = b;
    }
  }
  return out;
}

document.addEventListener("DOMContentLoaded", async () => {
  const display = document.getElementById("keyText");
  const copyBtn = document.getElementById("copyBtn");

  const params = new URLSearchParams(location.search);
  const keyParam = params.get("key");

  if (!keyParam) {
    display.innerText = "Lỗi: Không tìm thấy Key!";
    return;
  }

  try {
    const raw = atob(keyParam.replace(/-/g,"+").replace(/_/g,"/"));
    const data = Uint8Array.from(raw, c => c.charCodeAt(0));
    const ks = await keystream(data.length);
    const dec = data.map((b,i)=>b^ks[i]);
    display.innerText = new TextDecoder().decode(dec);
  } catch {
    display.innerText = "Key không hợp lệ!";
  }

  copyBtn.onclick = async () => {
    const text = display.innerText;
    if (text.includes("Lỗi") || text.includes("Đang")) return;

    await navigator.clipboard.writeText(text);
    copyBtn.innerText = "ĐÃ COPY!";
    copyBtn.style.background = "#fff";
    setTimeout(()=>{
      copyBtn.innerText = "COPY KEY";
      copyBtn.style.background =
        "linear-gradient(90deg,#00ff6a,#07b47a)";
    },1500);
  };
});
</script>

</body>
</html>
